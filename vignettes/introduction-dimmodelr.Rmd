---
title: "Introduction to dimmodelR"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{creating-a-dimensional-model}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

<!-- ```{r setup} -->
<!-- library(dimmodelR) -->
<!-- ``` -->

Business-intelligence tools such as Power BI, Tableau and Qlik work best if the 
data they connect to or import are organized as a so-called [dimensional model](https://en.wikipedia.org/wiki/Dimensional_modeling).



###

Transforming source data into a [dimensional model](https://en.wikipedia.org/wiki/Dimensional_modeling) 
is often a difficult, time-consuming and error-prone task within data 
engineering and business intelligence. 

The `dimmodelR` package makes this task easy using R. It provides a set of 
functions for automating the process of creating and refreshing a central data 
model consisting of multiple fact tables and a set of shared dimensions.

It supports the following workflow:

1. Split a data frame into a fact table and one or more dimensions (also known as a [star schema](https://en.wikipedia.org/wiki/Star_schema))
2. Create multiple star schemas from data frames and add them to the same model
3. Populate the model with data from a list of data frames and set up incremental refresh
4. Serve the model as csv or parquet files for tools such as Power BI, Tableau or Qlik


## Create a star schema

Imagine we want to transform data extracted from a web analytics tool such as 
Google Analytics into a star schema. We might have a dataset which looks like 
this:
```{r, eval=T}
library(dimmodelR)

head(web_metrics)


```

The dataset contains three numeric variables which which can be considered
facts: `sessions`, `transactions` and `revenue`. The rest of the columns provide
context to these facts and can be considered dimensions.

Let's decide to categorize them into two dimensions which we call `dim_channel` 
and `dim_market`:

```{r, eval=T}
dimensions <- list(
  dim_channel = c("source", "medium", "campaign"),
  dim_market = c("view_name", "country")
)
```

With this definition of dimensions, we can create a star schema using the
`dm_model` function:

```{r, eval=T}
dm <- dm_model(web_metrics, dimensions, return_facts = TRUE)

str(dm)
```


